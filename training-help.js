/**\n * نظام التدريب والمساعدة (Training & Help System)\n * \n * يوفر هذا النظام محتوى تدريبي ومساعدة للمستخدمين\n */\n\n/**\n * فئة الدرس (Lesson)\n */\nclass Lesson {\n  constructor(id, title, content, difficulty = 'beginner') {\n    this.id = id;\n    this.title = title;\n    this.content = content;\n    this.difficulty = difficulty; // beginner, intermediate, advanced\n    this.duration = content.split(' ').length / 200; // تقدير المدة بالدقائق\n    this.createdAt = new Date();\n    this.views = 0;\n    this.rating = 0;\n    this.reviews = [];\n  }\n\n  /**\n   * الحصول على معلومات الدرس\n   */\n  getInfo() {\n    return {\n      id: this.id,\n      title: this.title,\n      difficulty: this.difficulty,\n      duration: this.duration.toFixed(1),\n      views: this.views,\n      rating: this.rating\n    };\n  }\n\n  /**\n   * تسجيل عرض\n   */\n  recordView() {\n    this.views++;\n  }\n\n  /**\n   * إضافة تقييم\n   */\n  addReview(userId, rating, comment = '') {\n    this.reviews.push({\n      userId: userId,\n      rating: rating,\n      comment: comment,\n      timestamp: new Date().toISOString()\n    });\n\n    // تحديث التقييم العام\n    const totalRating = this.reviews.reduce((sum, r) => sum + r.rating, 0);\n    this.rating = (totalRating / this.reviews.length).toFixed(1);\n  }\n}\n\n/**\n * فئة المسار التدريبي (Training Path)\n */\nclass TrainingPath {\n  constructor(id, title, description, targetAudience = 'all') {\n    this.id = id;\n    this.title = title;\n    this.description = description;\n    this.targetAudience = targetAudience;\n    this.lessons = [];\n    this.createdAt = new Date();\n    this.completedBy = [];\n  }\n\n  /**\n   * إضافة درس للمسار\n   */\n  addLesson(lesson) {\n    this.lessons.push(lesson);\n    console.log('✅ تم إضافة درس للمسار:', lesson.title);\n  }\n\n  /**\n   * الحصول على معلومات المسار\n   */\n  getInfo() {\n    return {\n      id: this.id,\n      title: this.title,\n      description: this.description,\n      lessonCount: this.lessons.length,\n      totalDuration: this.getTotalDuration(),\n      completedBy: this.completedBy.length\n    };\n  }\n\n  /**\n   * الحصول على المدة الإجمالية\n   */\n  getTotalDuration() {\n    return this.lessons.reduce((sum, lesson) => sum + lesson.duration, 0).toFixed(1);\n  }\n\n  /**\n   * تسجيل إكمال المسار\n   */\n  markAsCompleted(userId) {\n    if (!this.completedBy.includes(userId)) {\n      this.completedBy.push(userId);\n    }\n  }\n}\n\n/**\n * فئة مقالة المساعدة (Help Article)\n */\nclass HelpArticle {\n  constructor(id, title, content, category = 'general') {\n    this.id = id;\n    this.title = title;\n    this.content = content;\n    this.category = category;\n    this.createdAt = new Date();\n    this.updatedAt = new Date();\n    this.views = 0;\n    this.helpful = 0;\n    this.notHelpful = 0;\n    this.tags = [];\n  }\n\n  /**\n   * الحصول على معلومات المقالة\n   */\n  getInfo() {\n    return {\n      id: this.id,\n      title: this.title,\n      category: this.category,\n      views: this.views,\n      helpful: this.helpful,\n      notHelpful: this.notHelpful\n    };\n  }\n\n  /**\n   * تسجيل عرض\n   */\n  recordView() {\n    this.views++;\n  }\n\n  /**\n   * تسجيل مفيد\n   */\n  markAsHelpful() {\n    this.helpful++;\n  }\n\n  /**\n   * تسجيل غير مفيد\n   */\n  markAsNotHelpful() {\n    this.notHelpful++;\n  }\n\n  /**\n   * الحصول على نسبة الفائدة\n   */\n  getHelpfulnessRatio() {\n    const total = this.helpful + this.notHelpful;\n    if (total === 0) return 0;\n    return ((this.helpful / total) * 100).toFixed(1);\n  }\n}\n\n/**\n * فئة الأسئلة الشائعة (FAQ)\n */\nclass FAQ {\n  constructor(id, question, answer, category = 'general') {\n    this.id = id;\n    this.question = question;\n    this.answer = answer;\n    this.category = category;\n    this.createdAt = new Date();\n    this.views = 0;\n  }\n\n  /**\n   * الحصول على معلومات السؤال\n   */\n  getInfo() {\n    return {\n      id: this.id,\n      question: this.question,\n      category: this.category,\n      views: this.views\n    };\n  }\n\n  /**\n   * تسجيل عرض\n   */\n  recordView() {\n    this.views++;\n  }\n}\n\n/**\n * فئة مدير التدريب والمساعدة (Training & Help Manager)\n */\nclass TrainingHelpManager {\n  constructor() {\n    this.lessons = [];\n    this.trainingPaths = [];\n    this.helpArticles = [];\n    this.faqs = [];\n    this.userProgress = new Map();\n    \n    this.initializeContent();\n  }\n\n  /**\n   * تهيئة المحتوى\n   */\n  initializeContent() {\n    // إضافة دروس\n    this.addLesson(new Lesson(\n      'lesson_1',\n      'البدء مع محرر البطاقات',\n      'تعلم كيفية استخدام محرر البطاقات الأساسي والميزات الرئيسية...',\n      'beginner'\n    ));\n\n    this.addLesson(new Lesson(\n      'lesson_2',\n      'تخصيص البطاقات',\n      'تعلم كيفية تخصيص ألوان وخطوط وتخطيطات البطاقات...',\n      'intermediate'\n    ));\n\n    // إضافة مسارات تدريبية\n    const beginnerPath = new TrainingPath(\n      'path_1',\n      'مسار المبتدئين',\n      'مسار شامل للمستخدمين الجدد',\n      'beginner'\n    );\n    this.trainingPaths.push(beginnerPath);\n\n    // إضافة مقالات مساعدة\n    this.addHelpArticle(new HelpArticle(\n      'article_1',\n      'كيفية حفظ البطاقة',\n      'اتبع هذه الخطوات لحفظ البطاقة بنجاح...',\n      'getting-started'\n    ));\n\n    // إضافة أسئلة شائعة\n    this.addFAQ(new FAQ(\n      'faq_1',\n      'كيف أغير لون البطاقة؟',\n      'انقر على أيقونة اللون في الشريط الجانبي واختر اللون المطلوب',\n      'customization'\n    ));\n\n    console.log('✅ تم تهيئة محتوى التدريب والمساعدة');\n  }\n\n  /**\n   * إضافة درس\n   */\n  addLesson(lesson) {\n    this.lessons.push(lesson);\n    console.log('✅ تم إضافة درس:', lesson.title);\n  }\n\n  /**\n   * الحصول على درس محدد\n   */\n  getLesson(lessonId) {\n    return this.lessons.find(l => l.id === lessonId);\n  }\n\n  /**\n   * الحصول على جميع الدروس\n   */\n  getAllLessons() {\n    return this.lessons.map(l => l.getInfo());\n  }\n\n  /**\n   * الحصول على الدروس حسب المستوى\n   */\n  getLessonsByDifficulty(difficulty) {\n    return this.lessons\n      .filter(l => l.difficulty === difficulty)\n      .map(l => l.getInfo());\n  }\n\n  /**\n   * إضافة مقالة مساعدة\n   */\n  addHelpArticle(article) {\n    this.helpArticles.push(article);\n    console.log('✅ تم إضافة مقالة مساعدة:', article.title);\n  }\n\n  /**\n   * البحث في مقالات المساعدة\n   */\n  searchHelpArticles(query) {\n    return this.helpArticles.filter(a => {\n      return a.title.includes(query) || \n             a.content.includes(query) ||\n             a.tags.some(tag => tag.includes(query));\n    }).map(a => a.getInfo());\n  }\n\n  /**\n   * الحصول على مقالات المساعدة حسب الفئة\n   */\n  getHelpArticlesByCategory(category) {\n    return this.helpArticles\n      .filter(a => a.category === category)\n      .map(a => a.getInfo());\n  }\n\n  /**\n   * إضافة سؤال شائع\n   */\n  addFAQ(faq) {\n    this.faqs.push(faq);\n    console.log('✅ تم إضافة سؤال شائع:', faq.question);\n  }\n\n  /**\n   * الحصول على الأسئلة الشائعة\n   */\n  getAllFAQs() {\n    return this.faqs.map(f => f.getInfo());\n  }\n\n  /**\n   * البحث في الأسئلة الشائعة\n   */\n  searchFAQs(query) {\n    return this.faqs.filter(f => {\n      return f.question.includes(query) || f.answer.includes(query);\n    }).map(f => f.getInfo());\n  }\n\n  /**\n   * إضافة مسار تدريبي\n   */\n  addTrainingPath(path) {\n    this.trainingPaths.push(path);\n    console.log('✅ تم إضافة مسار تدريبي:', path.title);\n  }\n\n  /**\n   * الحصول على جميع مسارات التدريب\n   */\n  getAllTrainingPaths() {\n    return this.trainingPaths.map(p => p.getInfo());\n  }\n\n  /**\n   * تسجيل تقدم المستخدم\n   */\n  recordUserProgress(userId, lessonId, completed = true) {\n    if (!this.userProgress.has(userId)) {\n      this.userProgress.set(userId, []);\n    }\n\n    const progress = this.userProgress.get(userId);\n    progress.push({\n      lessonId: lessonId,\n      completed: completed,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  /**\n   * الحصول على تقدم المستخدم\n   */\n  getUserProgress(userId) {\n    return this.userProgress.get(userId) || [];\n  }\n\n  /**\n   * الحصول على إحصائيات التدريب\n   */\n  getTrainingStats() {\n    return {\n      totalLessons: this.lessons.length,\n      totalTrainingPaths: this.trainingPaths.length,\n      totalHelpArticles: this.helpArticles.length,\n      totalFAQs: this.faqs.length,\n      usersInProgress: this.userProgress.size,\n      mostViewedLesson: this.getMostViewedLesson(),\n      mostHelpfulArticle: this.getMostHelpfulArticle()\n    };\n  }\n\n  /**\n   * الحصول على أكثر درس مشاهدة\n   */\n  getMostViewedLesson() {\n    if (this.lessons.length === 0) return null;\n    return this.lessons.reduce((max, lesson) => \n      lesson.views > max.views ? lesson : max\n    ).getInfo();\n  }\n\n  /**\n   * الحصول على أكثر مقالة مفيدة\n   */\n  getMostHelpfulArticle() {\n    if (this.helpArticles.length === 0) return null;\n    return this.helpArticles.reduce((max, article) => \n      parseFloat(article.getHelpfulnessRatio()) > parseFloat(max.getHelpfulnessRatio()) ? article : max\n    ).getInfo();\n  }\n}\n\n// تصدير الفئات\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    Lesson,\n    TrainingPath,\n    HelpArticle,\n    FAQ,\n    TrainingHelpManager\n  };\n}\n
